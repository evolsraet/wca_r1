# NICE 본인확인(통합형) API - FAQ (Version 1.0)

**작성일**: 2024년 1월 30일  
**작성자**: NICE평가정보(주) DI개발실

### 계정정보
- ID : ksw654
- PW : wecar00!@

---

## 📚 목차
1. [API 공통 오류](#api-공통-오류)
2. [본인확인(통합형) 관련 오류](#본인확인통합형-관련-오류)

---

## API 공통 오류

### Q1. 토큰 발급 시 1702 오류 발생
- **원인**: `Authorization`의 `clientID` 값과 등록된 공인 IP가 일치하지 않을 경우 발생.
- **해결**: 
  - `niceapi.co.kr`에서 등록된 공인 IP를 확인합니다.
  - **사설 IP 사용 불가**, **도메인 등록 불가**.

---

### Q2. 기관 토큰 발급 시 `expires_in` 시간
- `expires_in`은 **만료까지 남은 시간(초)**을 의미.
- 날짜로 변경하면 안 되며, UNIX 시간 기준으로 계산됩니다.

---

### Q3. 암호화 토큰 발급 시 1706 오류 발생
- **원인**: `clientID`와 `productID`가 일치하지 않는 경우.
- **해결**:
  - 요청 헤더에 **상품코드**를 정확히 포함.
  - 승인된 서비스의 `clientID` 사용 여부 확인.
  - 승인되지 않았다면 **계약 담당자** 또는 `02-2122-4615`로 문의.

---

### Q4. 암호화 토큰 발급 시 1800 오류 발생
- **원인**: `unixtime`이 실제 시간과 **3분 이상 차이**가 날 경우.
- **해결**: 실시간 `unixtime`을 사용해야 함.

---

### Q5. 암호화 토큰 발급 시 1500 오류 발생
- **원인**: JSON 형태의 파라미터가 제대로 전달되지 않는 경우.
- **해결**:
  - `dataHeader`와 `dataBody` 두 개의 key 값으로 전달.
  - `req_dtim`, `req_no`, `enc_mode`는 **string** 값으로 전달.

---

## 본인확인(통합형) 관련 오류

### Q6. 특정 값들이 나오지 않는 경우 (CI, 휴대폰번호 등)
- 기본 제공 리턴값: **이름, 생년월일, 성별, 내외국인, DI값**.
- 그 외 값이 누락된다면 **계약담당자** 또는 `02-2122-4615`로 문의.

---

### Q7. 법인폰 인증
- 법인폰은 **개인 정보 등록**이 되어 있어야 인증 가능.
- 등록 관련 사항은 **각 통신사**에 문의.

---

### Q8. "해당 인증서는 본 사이트에서 사용이 불가능합니다." 오류
- 공동인증서의 인증 구분:
  - **개인/사업자** 인증서에 따라 사용 가능한 인증기관이 다름.
  - (예: 한국정보인증, 한국전자인증, 코스콤 등)
- **계약형태**에 맞는 인증서를 사용해야 함.

---

### Q9. SMS 인증 문자가 오지 않는 경우
1. 사용자 인증정보가 틀린 경우.
2. 고객 핸드폰에 스팸 번호(1600-1522)가 등록된 경우.
3. 업체 정보(CP 값)가 통신사에 등록되지 않은 경우:
   - 등록 기간은 **7~10일** 소요.
   - 정확한 확인은 **계약 담당자** 또는 `02-2122-4615`로 문의.

---

### Q10. "세션값이 다릅니다" 오류
- **원인**: 서버 설정에 따라 프로토콜 변경이나 URL 리다이렉션이 발생할 경우.
- **해결**:
  - 세션 정보를 정확히 확인하고 설정 수정.
  - 어려운 경우, success 페이지에서 **세션 비교 부분 주석 처리** 가능.

---

### Q11. 웹뷰 구현 시, `intent` 주소 URL Schema 오류
- **원인**: 웹뷰 구현 시, Pass앱 또는 스토어로 이동하는 URL에 대한 처리 미흡.
- **해결**:
  - 당사 제공 모듈 파일을 참고하여 URL 분기처리.
  - `intent` 처리가 어렵다면 **간편인증(PUSH)** 방식으로 변경 가능.

---

### Q12. ERROR_CODE: 9999 오류 발생
- **원인**: 필수 `form` 데이터 누락 시 발생.
- **해결**: `iframe` 또는 `layer` 사용 시 누락되는 데이터를 확인.

---

### Q13. 팝업창을 `iframe` 혹은 `layer popup`으로 구현 시 오류
- **원인**: 독립 도메인에서 `iframe` 사용 시 보안 정책에 위배.
- **해결**:
  - 독립된 팝업창으로 구현해야 함.
  - iOS 13 이상에서는 쿠키 처리 정책이 변경되어 오류 발생 가능.

---

### Q14. "잘못된 요청이거나 서비스 처리 중 오류가 발생했습니다." 팝업 오류
- **원인**: 필수 데이터 누락이나 변형 시 발생.
- **확인할 항목**:
  - `<input type="hidden" name="token_version_id" value="">`
  - `<input type="hidden" name="enc_data" value="">`
  - `<input type="hidden" name="integrity_value" value="">`
  - **URL**: `https://nice.checkplus.co.kr/CheckPlusSafeModel/checkplus.cb`

---

### Q15. GET/POST 방식
- 인증 완료 후:
  - 크롬은 **GET** 방식.
  - 그 외 브라우저는 **POST** 방식.
- 브라우저 상관없이 **GET** 방식으로 전달받으려면 `methodtype`을 `get`으로 설정.

---

### Q16. 특정 값들이 나오지 않는 경우 (CI, 휴대폰번호 등)
- 기본 제공 리턴값 외의 값이 나오지 않는 경우는 **계약 담당자** 또는 `02-2122-4615`로 문의.
- 암호화된 데이터 복호화 후, 각 값들의 key 값을 확인하여 사용.

---

## 📞 문의처
- 계약 담당자 또는 02-2122-4615